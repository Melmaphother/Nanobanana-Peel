# üçå Nanobanana Peel - Remove Background for AI-Generated Images

A lightweight Python tool to remove backgrounds from AI-generated images by adding transparency.

English | [ÁÆÄ‰Ωì‰∏≠Êñá](README_zh.md)

## üéØ Why This Tool?

Images generated by AI models (like GPT-4o, Gemini, Claude, Grok, DALL-E 3, Midjourney, Flux, Stable Diffusion, and even the latest Nano Banana Pro üçå) often have two problems:

1. **Backgrounds are not pure white**: They have a slight yellowish or off-white tint, which looks ugly when pasted into documents or presentations
2. **PNGs lack alpha channel**: Even if the background appears "white", it's in RGB format without transparency, causing occlusion when layered with other elements

This tool solves both problems at once:
- Detects pixels close to the background color and makes them fully transparent
- Outputs a clean PNG with alpha channel

## ‚ú® Before & After

| Original Image | After Processing |
|:--------------:|:----------------:|
| ![Original](assets/1.png) | ![Processed](assets/1_rmbg.png) |

> Left: The original image has a subtle grayish background. Right: Clean image with transparent background.

## üì¶ Installation

### Requirements

- Python 3.9+
- NumPy
- Pillow

### Install Dependencies

```bash
pip install numpy pillow
```

### Clone the Repository

```bash
git clone https://github.com/Melmaphother/Nanobanana-Peel.git
cd Nanobanana-Peel
```

## üöÄ Usage

### Basic Usage

```bash
# Process a single image (output: input_rmbg.png)
python rmbg.py -i input.png

# Process with custom output path
python rmbg.py -i input.png -o output.png
```

### Batch Processing

```bash
# Process multiple images at once
python rmbg.py -i image1.png image2.png image3.png

# Output files: image1_rmbg.png, image2_rmbg.png, image3_rmbg.png
```

### With Custom Thresholds

```bash
# More aggressive background removal (lower threshold)
python rmbg.py -i input.png --transparent 0.05

# Semi-transparent transition zone
python rmbg.py -i input.png --transparent 0.05 --opaque 0.3
```

### Remove Non-White Background

```bash
# Remove black background
python rmbg.py -i input.png --background 0,0,0

# Remove custom color background (RGB)
python rmbg.py -i input.png --background 128,128,128
```

## ‚öôÔ∏è Parameters

| Parameter | Default | Description |
|-----------|---------|-------------|
| `-i, --input` | (required) | Path(s) to the input image(s). Supports multiple files for batch processing |
| `-o, --output` | `<input>_rmbg.png` | Path to save the output image. Only valid for single file input. If not specified, output will be saved as `<input_name>_rmbg.png` |
| `--transparent` | `0.1` | Distance threshold (0-1). Pixels with color distance below this become fully transparent |
| `--opaque` | `1.0` | Distance threshold (0-1). Pixels with color distance above this remain fully opaque |
| `--background` | `255,255,255` | Background color to detect as `R,G,B` |

### Understanding Thresholds

The tool calculates the "color distance" between each pixel and the specified background color:

- **Distance = 0**: Pixel is exactly the background color
- **Distance = 1**: Pixel is the maximum possible distance from background

With default settings (`--transparent 0.1`):
- Pixels within 10% distance of white ‚Üí **Transparent**
- All other pixels ‚Üí **Keep original**

## üîß Global Installation (Add to Shell)

Want to use `rmbg` from anywhere? Add an alias to your shell configuration:

### For Zsh (~/.zshrc)

```bash
# Add this line to your ~/.zshrc
alias rmbg="python /path/to/Nanobanana-Peel/rmbg.py"

# Then reload
source ~/.zshrc
```

### For Bash (~/.bashrc)

```bash
# Add this line to your ~/.bashrc
alias rmbg="python /path/to/Nanobanana-Peel/rmbg.py"

# Then reload
source ~/.bashrc
```

Now you can use it from anywhere:

```bash
# Single file (auto-generates ai_image_rmbg.png)
rmbg -i ~/Downloads/ai_image.png

# With custom output path
rmbg -i ~/Downloads/ai_image.png -o ~/Downloads/ai_image_transparent.png

# Batch processing
rmbg -i ~/Downloads/*.png
```

## üìê How It Works

1. **Load Image**: Read the input PNG file
2. **Calculate Distance**: For each pixel, compute the Euclidean distance to the background color in RGB space
3. **Normalize**: Distance is normalized to [0, 1] range (max distance ‚âà 441.67 for RGB)
4. **Apply Transparency**: 
   - Distance < `transparent_threshold` ‚Üí Alpha = 0 (fully transparent)
   - Distance > `opaque_threshold` ‚Üí Alpha = 255 (fully opaque)
   - In between ‚Üí Keep original alpha
5. **Save**: Output as PNG with alpha channel

## üìù Example Workflow

```bash
# 1. Download an AI-generated image
# 2. Remove the background (auto-generates ai_generated_rmbg.png)
rmbg -i ai_generated.png

# 3. For images with stronger yellow tint, use lower threshold
rmbg -i yellow_bg.png --transparent 0.15

# 4. Batch process all images in a folder
rmbg -i *.png
```

## üìÑ License

MIT License - feel free to use and modify as needed.

## ü§ù Contributing

Issues and Pull Requests are welcome!

